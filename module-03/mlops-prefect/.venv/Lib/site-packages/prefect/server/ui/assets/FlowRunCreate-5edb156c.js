import{aF as k,d as D,v as F,m as I,aG as N,c as m,aH as T,a as V,u as t,g as x,w as d,i as J,h as O,E as b,o as B,k as i,aI as P,aJ as A,aK as U,aL as z,Y as y,aD as f}from"./index-90a34f95.js";import{u as E}from"./usePageTitle-0cc457c9.js";class G extends k{parse(a){return JSON.parse(decodeURIComponent(a??""))}format(a){return encodeURIComponent(JSON.stringify(a))}}const L=D({__name:"FlowRunCreate",setup(_){const a=F(),s=I("deploymentId"),n=b(),c=N("parameters",G,void 0),v=m(()=>!e.value||!c.value?{}:T.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:c.value},"SchemaValues")),w=V(a.deployments.getDeployment,[s]),e=m(()=>w.response),R=async r=>{var l,o;try{const u=await a.deployments.createDeploymentFlowRun(s.value,r),p=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,g=!p,S=U(z,{flowRun:u,flowRunRoute:y.flowRun,router:n,immediate:g,startTime:p});f(S,"success"),n.push(y.deployment(s.value))}catch(u){f("Something went wrong trying to create a flow run","error"),console.error(u)}},h=()=>{n.back()},C=m(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return E(C),(r,l)=>{const o=O("p-layout-default");return t(e)?(B(),x(o,{key:0},{header:d(()=>[i(t(P),{deployment:t(e)},null,8,["deployment"])]),default:d(()=>[i(t(A),{deployment:t(e),parameters:t(v),onSubmit:R,onCancel:h},null,8,["deployment","parameters"])]),_:1})):J("",!0)}}});export{L as default};
